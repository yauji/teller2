{% extends "base.html" %}

{% block nav_trans %}active{% endblock %}


{% block contents %} 

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

    <form class="form-inline">
    <label class="sr-only" for="inlineFormInput">Name</label>
    <input type="text" class="form-control mb-2 mr-sm-2 mb-sm-0" id="inlineFormInput" placeholder="Jane Doe">

    <label class="sr-only" for="inlineFormInputGroup">Username</label>
    <div class="input-group mb-2 mr-sm-2 mb-sm-0">
    <div class="input-group-addon">@</div>
    <input type="text" class="form-control" id="inlineFormInputGroup" placeholder="Username">
    </div>

    <div class="form-check mb-2 mr-sm-2 mb-sm-0">
    <label class="form-check-label">
    <input class="form-check-input" type="checkbox"> Remember me
</label>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
    </form>



<form action="{% url 'trans:add' %}" method="post" class="form-inline">
    {% csrf_token %}
    <label class="mr-sm-2" for="inlineFormCustomSelect">Date</label>
    <input type="text" class="form-control mb-2 mr-sm-2 mb-sm-0 datepicker" id="date" name="date">

    <label class="mr-sm-2" for="inlineFormCustomSelect">Name</label>
    <input type="text" class="form-control mb-2 mr-sm-2 mb-sm-0" id="name" name="name">

  expense:<input type="text" name="expense" id="expense"/>

  memo:<input type="text" name="memo" id="memo"/>

  category:
  <select name="cg" id="cg">
    {% for cg in categorygroup_list %}    
    <option value="{{cg.id}}">{{cg.name}}</opetion>
    {% endfor %}
  </select>
  
  <select name="c" id="c">
    {% for c in category_list %}    
    <option value="{{c.id}}">{{c.name}}</opetion>
    {% endfor %}
  </select>

  pmethod:
  <select name="pmg" id="pmg">
    {% for pmg in pmgroup_list %}    
    <option value="{{pmg.id}}">{{pmg.name}}</opetion>
    {% endfor %}
  </select>

  <select name="pm" id="pm">
    {% for pm in pmethod_list %}    
    <option value="{{pm.id}}">{{pm.name}}</opetion>
    {% endfor %}
  </select>

  <select name="share_type" id="share_type">
    <option value="1">own</opetion>
    <option value="2">share</opetion>
    <option value="3">pay4other</opetion>
  </select>
  <input type="text" name="user_pay4" id="user_pay4"/>
  
    <button type="submit" class="btn btn-primary">Add</button>
</form>



    <form action="{% url 'trans:delete' %}" method="post">
	<!--	-->
      {% csrf_token %}
    
    <table border="1" class="table table-striped">
      <tr>
	<th></th>
	<th></th>
	<th>Date</th>
	<th>Item</th>
	<th>Expense</th>
	<th>Balance</th>
	<th></th>
	<th></th>
	<th></th>
	<th></th>
      </tr>
      {% for trans in latest_trans_list %}
      <tr>
	<td> <input type="checkbox" name="tids" value="{{ trans.id }}" /></td>
	<td>{{ trans.id }}</td>
	<td>{{ trans.date }}</td>
	<td>{{ trans.name }}</td>
	<td>{{ trans.expense }}</td>
	<td>{{ trans.balance }}</td>
	<td>{{ trans.pmethod.name }}</td>
	<td>{{ trans.category.name }}</td>
	<td>{{ trans.user }}</td>
	<td>{{ trans.share_type }}</td>
	<td>{{ trans.user_pay4 }}</td>
	<td><a href="">{{ trans.trans_text }}</a></td>

      </tr>
      {% endfor %}
    </table>
      <input type="submit" value="Delete" />
</form>

{% endblock contents %}



{% block script %}
$(function() {
    //init format---
    $('#user_pay4').css('display', 'none');

    $('.datepicker').datepicker({
	format: "yyyy/mm/dd"
    });

    //events---
    $('#cg').change(function(e) {
	url = 'categorygroup/' + e.target.value+ '/list/';
	$.ajax(url,
	       {
		   type: 'get',
		   //data: { query: $('#keyword').val() },
		   //dataType: 'xml'
	       }
	      )
	    .done(function(data) {
		var jsondata = $.parseJSON(data);
		$('#c option').remove();
		for(var i in jsondata.category_list){
		    $('#c').append("<option value='" + jsondata.category_list[i].id + "'>" + jsondata.category_list[i].name + "</option>");
		}
	    });
    });


    $('#pmg').change(function(e) {
	url = 'pmgroup/' + e.target.value+ '/list/';
	$.ajax(url,
	       {
		   type: 'get',
	       }
	      )
	    .done(function(data) {
		var jsondata = $.parseJSON(data);
		//alert(data);
		$('#pm option').remove();
		for(var i in jsondata.pmethod_list){
		    $('#pm').append("<option value='" + jsondata.pmethod_list[i].id + "'>" + jsondata.pmethod_list[i].name + "</option>");
		}
	    });
    });

    $('#share_type').change(function(e) {
	//3 is pay4other
	if( e.target.value == 3 ){
	    //alert('pay for');
	    $('#user_pay4').css('display', 'inline');
	}else{
	    $('#user_pay4').css('display', 'none');
	}
    });


});
{% endblock script %}
  









    
    
